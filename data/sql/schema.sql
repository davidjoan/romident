CREATE TABLE t_appointment (id BIGINT AUTO_INCREMENT, patient_id BIGINT, date_of_quote DATETIME, title VARCHAR(50), descriptions TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_active_idx (active), UNIQUE INDEX t_appointment_sluggable_idx (slug), INDEX patient_id_idx (patient_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_dental_history (id BIGINT AUTO_INCREMENT, name VARCHAR(200) NOT NULL, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_name_idx (name), INDEX i_active_idx (active), UNIQUE INDEX t_dental_history_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_dentist (id BIGINT AUTO_INCREMENT, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, gender CHAR(1) DEFAULT '1' NOT NULL, email VARCHAR(100) NOT NULL, home_phones VARCHAR(200) NOT NULL, office_phones VARCHAR(200) NOT NULL, mobile_phone VARCHAR(200), fax VARCHAR(200), description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_firstname_idx (firstname), INDEX i_lastname_idx (lastname), UNIQUE INDEX u_email_idx (email), INDEX i_active_idx (active), UNIQUE INDEX t_dentist_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_diagnosis (id BIGINT AUTO_INCREMENT, patient_id BIGINT, tooth VARCHAR(50), diagnosis TEXT, treatment TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_active_idx (active), UNIQUE INDEX t_diagnosis_sluggable_idx (slug), INDEX patient_id_idx (patient_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_holder (id BIGINT AUTO_INCREMENT, code VARCHAR(20) NOT NULL, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, gender CHAR(1) DEFAULT '1' NOT NULL, company VARCHAR(100), email VARCHAR(100) NOT NULL, home_phones VARCHAR(200), office_phones VARCHAR(200), mobile_phone VARCHAR(200), fax VARCHAR(200), description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_firstname_idx (firstname), INDEX i_lastname_idx (lastname), UNIQUE INDEX u_email_idx (email), INDEX i_active_idx (active), UNIQUE INDEX t_holder_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_medical_history (id BIGINT AUTO_INCREMENT, name VARCHAR(200) NOT NULL, description TEXT, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_name_idx (name), INDEX i_active_idx (active), UNIQUE INDEX t_medical_history_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_patient (id BIGINT AUTO_INCREMENT, holder_id BIGINT, dentist_id BIGINT, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, gender CHAR(1) DEFAULT '1' NOT NULL, date_of_birth DATETIME, description TEXT, treatments TEXT, brush_teeth VARCHAR(100), different_brush VARCHAR(100), consultation TEXT, type CHAR(1) DEFAULT '1' NOT NULL, active CHAR(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_firstname_idx (firstname), INDEX i_lastname_idx (lastname), INDEX i_active_idx (active), INDEX i_type_idx (type), UNIQUE INDEX t_patient_sluggable_idx (slug), INDEX holder_id_idx (holder_id), INDEX dentist_id_idx (dentist_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_patient_dental_history (patient_id BIGINT, dental_history_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_created_at_idx (created_at), INDEX i_updated_at_idx (updated_at), PRIMARY KEY(patient_id, dental_history_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_patient_medical_history (patient_id BIGINT, medical_history_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_created_at_idx (created_at), INDEX i_updated_at_idx (updated_at), PRIMARY KEY(patient_id, medical_history_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_user (id BIGINT AUTO_INCREMENT, realname VARCHAR(200) NOT NULL, username VARCHAR(50) NOT NULL, password VARCHAR(255) NOT NULL, email VARCHAR(100) NOT NULL, url VARCHAR(255), twitter_username VARCHAR(100), phone VARCHAR(100), active CHAR(1) DEFAULT '0' NOT NULL, last_access_at DATETIME, slug VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_username_idx (username), UNIQUE INDEX u_email_idx (email), INDEX i_url_idx (url), INDEX i_twitter_username_idx (twitter_username), INDEX i_active_idx (active), UNIQUE INDEX t_user_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
CREATE TABLE t_visit (id BIGINT AUTO_INCREMENT, remote_address VARCHAR(50) NOT NULL, remote_port VARCHAR(50) NOT NULL, http_user_agent VARCHAR(255) NOT NULL, datetime datetime NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX i_remote_address_idx (remote_address), INDEX i_datetime_idx (datetime), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_bin ENGINE = INNODB;
ALTER TABLE t_appointment ADD CONSTRAINT t_appointment_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_diagnosis ADD CONSTRAINT t_diagnosis_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient ADD CONSTRAINT t_patient_holder_id_t_holder_id FOREIGN KEY (holder_id) REFERENCES t_holder(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient ADD CONSTRAINT t_patient_dentist_id_t_dentist_id FOREIGN KEY (dentist_id) REFERENCES t_dentist(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient_dental_history ADD CONSTRAINT t_patient_dental_history_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient_dental_history ADD CONSTRAINT t_patient_dental_history_dental_history_id_t_dental_history_id FOREIGN KEY (dental_history_id) REFERENCES t_dental_history(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient_medical_history ADD CONSTRAINT tmti FOREIGN KEY (medical_history_id) REFERENCES t_medical_history(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE t_patient_medical_history ADD CONSTRAINT t_patient_medical_history_patient_id_t_patient_id FOREIGN KEY (patient_id) REFERENCES t_patient(id) ON UPDATE CASCADE ON DELETE CASCADE;
